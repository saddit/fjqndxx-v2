# é’å¹´å¤§å­¦ä¹ /å›¢è¯¾è‡ªåŠ¨æ‰“å¡

![](https://github.com/838239178/tk-auto-study/workflows/auto-study/badge.svg) ![](https://img.shields.io/github/stars/838239178/tk-auto-study) ![](https://img.shields.io/github/forks/838239178/tk-auto-study) ![](https://img.shields.io/badge/Python-3.7-green.svg)

[æ­¤å¤„å±•ç¤ºæœ€è¿‘æ›´æ–°æ—¥å¿—ï¼Œå®Œæ•´æ—¥å¿—æ“è¿™é‡Œ](./doc/Log.md)

> 2022.06.17ï¼šâš  **é‡è¦ï¼šéªŒè¯ç æ£€æµ‹å›å½’**ï¼Œç°åœ¨éœ€è¦éªŒè¯ç è¯†åˆ«æŠ€æœ¯ï¼Œè¯·ä½¿ç”¨`1.3.0`åŠä»¥ä¸Šç‰ˆæœ¬ã€‚âš 
>
> 2022.06.22: æ–°å¢æœ¬åœ°OCRè¯†åˆ«ï¼Œéå¸¸æ„Ÿè°¢@sqlpxcè´¡çŒ®äº†[Rustç¼–å†™çš„OCRè¯†åˆ«ç¨‹åº](https://github.com/sqlpxc/cyl_auto_punch_rust)ï¼Œä½¿ç”¨æ–¹æ³•çœ‹ä¸‹é¢â€œå¯é€‰è¯†åˆ«ç±»å‹â€
>
> 2022.07.28: æ–°å¢å¾®è½¯Azureçš„è®¡ç®—æœºè§†è§‰OCRï¼Œä»”ç»†é˜…è¯»å¸®åŠ©æ–‡æ¡£æ¥ä½¿ç”¨è¿™ä¸ªæ–°åŠŸèƒ½
>
> 2022.08.24: æ–°å¢é…ç½® maxRetry è‡ªå®šä¹‰æœ€å¤§é‡è¯•æ¬¡æ•°

ğŸ¤ºå¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘å›¢è¯¾æ²¡çœ‹è¢«å›¢æ”¯ä¹¦èµ¶ç€å‚¬äº†

### ç‚¹ä¸ª:star:å†èµ°å§,â¤æ„Ÿè°¢å¤§å®¶çš„Starå’ŒFork,æœ‰é—®é¢˜å¯ä»¥å‘issue

**ä»…ä¾›ç¦å»ºå…±é’å›¢å›¢å‘˜å­¦ä¹ äº¤æµä½¿ç”¨** é¡¹ç›®éµå¾ªGPLåè®®ï¼Œè¯·å‹¿æ‹¿æ¥ç›ˆåˆ©ã€è¯ˆéª—å’Œè¿æ³•ä¹‹äº‹ï¼å¦åˆ™åæœéœ€è¦è‡ªè´Ÿã€‚

### å‚ä¸è´¡çŒ®ï¼

ğŸ–Šï¸ å¦‚æœä½ æœ‰æ–°çš„æˆ–æ›´å¥½OCRè¯†åˆ«æ–¹å¼ è¯·å‚è€ƒ [OCRè´¡çŒ®æ–‡æ¡£](https://github.com/838239178/tk-auto-study/blob/1.2.5/doc/OCR_Module_Rule.md) åšå‡ºä½ çš„è´¡çŒ®ï¼

ğŸ–Šï¸ å¦‚æœä½ æœ‰æ–°çš„æˆ–æ›´å¥½æ¶ˆæ¯æ¨é€æ–¹å¼ è¯·å‚è€ƒ [æ¶ˆæ¯æ¨é€è´¡çŒ®æ–‡æ¡£](https://github.com/838239178/tk-auto-study/blob/1.2.5/doc/send_module_rule.md) åšå‡ºä½ çš„è´¡çŒ®ï¼

## ä½¿ç”¨æ–¹æ³•

#### ğŸpub_key:

```
A7E74D2B6282AEB1C5EA3C28D25660A7
```

#### ç”³è¯·Ocrè¯†åˆ«æ¥å£çš„æƒé™ ï¼ˆ1.3.1ç‰ˆæœ¬ä»¥åå¯é€‰æœ¬åœ°OCRï¼Œå¦‚æœä¸ä½¿ç”¨BaiduAPIåˆ™è·³è¿‡è¯¥æ­¥éª¤ï¼‰

[è¯¦ç»†æ•™ç¨‹è¯·ç‚¹å‡»è¿™é‡Œ](https://blog.pressed.top/2021/02/14/signUpBaiduOcr/)

*è¯·é€‰æ‹©ä½¿ç”¨ä¸€ç§å¯ä»¥è¯†åˆ«æ–‡å­—çš„apiï¼Œå»ºè®®ä½¿ç”¨BaiduAIçš„Ocræ¥å£*

- é¦–å…ˆè¦æœ‰ä¸€ä¸ªç™¾åº¦è´¦å·ï¼Œè¿›å…¥[è¿™ä¸ªç½‘å€](https://ai.baidu.com/)ï¼Œç‚¹å‡»æ§åˆ¶å°å¹¶ç™»å½•
- å®Œæˆä¸ªäººå®åè®¤è¯ï¼Œç”³è¯·æ–‡å­—è¯†åˆ«çš„ä½¿ç”¨æƒ
- ç‚¹å‡»ç®¡ç†åº”ç”¨ï¼Œç‚¹å‡»åˆ›å»ºåº”ç”¨ï¼ŒæŒ‰è¦æ±‚å¡«ä¸€äº›ä¿¡æ¯ï¼Œåˆ›å»ºå®Œæˆåè®°ä½**API KEY**å’Œ**SECRET KEY**

#### éƒ¨ç½²åœ¨å¹³å°ä¸Šå®šæ—¶æ‰§è¡Œ

è¿™é‡Œä»‹ç»å¦‚ä½•åœ¨GitHubActionsä¸­è¿è¡Œï¼Œå› ä»£ç†IPçš„ç›¸å…³ä»£ç ï¼Œéœ€ç¡®ä¿**Python3.9**åŠä»¥ä¸Šç‰ˆæœ¬ã€‚

- forkè¯¥é¡¹ç›®åˆ°ä½ çš„åº“ä¸­

- æ·»åŠ ä¸‰ä¸ªsecretsï¼Œåˆ†åˆ«ä¸ºï¼šusername,  pwd,  pub_key

- `1.3.0`å¼€å§‹ï¼Œéœ€è¦æ·»åŠ éªŒè¯ç è¯†åˆ«çš„OCRçš„ ocr_api_keyï¼Œocr_secret_keyï¼Œocr_type

- å°†[è¯¥æ–‡ä»¶](./.github/workflows/run.yml)ä¸­çš„`#`åˆ é™¤å¹¶ä¿®æ”¹cronä¸ºä½ æƒ³è¦è§¦å‘çš„æ—¶é—´ï¼Œé»˜è®¤æ˜¯æ¯å‘¨ä¸‰14ç‚¹è¿è¡Œä¸€æ¬¡ï¼Œcronå¦‚ä½•å†™è¯·è‡ªè¡Œç™¾åº¦

  ![image](https://user-images.githubusercontent.com/55338151/161259594-21812419-25e3-4b1f-b64f-e06b826351b8.png)

- è¿›å…¥ Actions ä¸­æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡ï¼ˆç‚¹å‡»auto-study å³è¾¹ Run workflow)ï¼Œæµ‹è¯•æ˜¯å¦æˆåŠŸ
  
  ![image](https://user-images.githubusercontent.com/55338151/161258385-eccd7f2f-8b7e-4002-aa8b-c436e96c01d7.png)

> `1.2.8` ç‰ˆæœ¬ä»¥ä¸Šå¯ä»¥ä½¿ç”¨Dockerè„šæœ¬è¿è¡Œï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®å‚æ•°ï¼ˆæ ¼å¼åŒActions)ï¼Œå¯èƒ½æ— æ³•é…ç½®å¤šäººæ‰“å¡ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨`\n`æ¢è¡Œç¬¦ï¼ˆæœªæµ‹è¯•ï¼‰

### å¦‚ä½•åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²

åœ¨æœ¬åœ°æˆ–è€…å›½å†…æœåŠ¡å™¨ä¸Šéƒ¨ç½²ä¸éœ€è¦ä»£ç†ï¼Œå¯å…¼å®¹**Python3.7**ç‰ˆæœ¬

#### crontab

å…‹éš†é¡¹ç›®å¹¶æ›´æ”¹é…ç½®æ–‡ä»¶åç§°

```shell
git clone https://github.com/838239178/tk-auto-study.git && \
cd tk-auto-study && \
mv config.json.bak config.json
```

æŒ‰ç…§è¦æ±‚å¡«å†™é…ç½®æ–‡ä»¶

```shell
vi config.json
```

ä¿®æ”¹ crontab

```shell
crontab -e
# å°†ä¸‹é¢è¿™è¡Œå¤åˆ¶åˆ°é‡Œé¢ï¼Œcdçš„è·¯å¾„æŒ‰ç…§éœ€è¦æ›´æ”¹
00 08 * * 3 cd /root/tk-auto-study && python3 main.py >> crontab.log 2>&1
# æˆ–è€…
00 08 * * 3 python3 /root/tk-auto-study/main.py >> crontab.log 2>&1
```

ä½¿ç”¨ `crontab -l` æŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸ

#### docker

é™¤äº†crontabä¹Ÿå¯ä»¥ä½¿ç”¨ç›®å½•ä¸‹çš„`docker-compose.yml`ï¼Œä¸éœ€è¦å¡«å†™ `config.json` ä½†éœ€è¦ä¿®æ”¹æ–‡ä»¶å†…çš„`environments`

```shell
docker-compose up -d
```

## å¯é€‰è¯†åˆ«ç±»å‹

> `1.3.0` åŠä»¥ä¸Š  

GithubActionï¼ˆå¯é€‰ï¼‰æ·»åŠ æ–°çš„secrets:ocr_typeæ¥æŒ‡å®šè¯†åˆ«ç±»å‹

å…¶ä»–æ–¹å¼åœ¨config.jsonä¸­ä¿®æ”¹æŒ‡å®šé…ç½®é¡¹å³å¯

| å¯é€‰å€¼      | ä½¿ç”¨æ–¹æ³•                                                     | æ”¯æŒç‰ˆæœ¬ |
| ----------- | ------------------------------------------------------------ | -------- |
| baidu_image | [é»˜è®¤æ–¹æ³•,éœ€è¦åˆ°ç™¾åº¦AIä¸­ç”³è¯·](https://blog.pressed.top/2021/02/14/signUpBaiduOcr/) | 1.3.0    |
| tesseract   | [æœ¬åœ°ocrè¯†åˆ«,Windowsæ¨è,Linuxéœ€è¦å®‰è£…é…ç½®](./doc/ocr_help/tesseract.md) | 1.3.1    |
| azure       | [éœ€è¦å¾®è½¯è´¦å·ç”³è¯·](./doc/ocr_help/azure.md)                  | 1.3.2    |
| pytesseract | [éœ€è¦å®‰è£…ä¾èµ–ï¼Œæ¨èlinuxä¸‹ä½¿ç”¨](./doc/ocr_help/pytesseract.md) | 1.3.3    |

## å¯é€‰æ¶ˆæ¯æ¨é€

> ä»… `1.2.2` ç‰ˆæœ¬åŠä»¥ä¸Šå¯ç”¨

ä½¿ç”¨æ¶ˆæ¯æ¨é€ å¦‚å¾®ä¿¡æ¨é€ã€QQæ¨é€

### é…ç½®

GithubActionç”¨æˆ·å¯é€šè¿‡æ·»åŠ secretsï¼šsend_type, send_key, send_mode æ¥ä½¿ç”¨æ¶ˆæ¯æ¨é€

æ™®é€šç”¨æˆ·å¯æŸ¥çœ‹æœ€æ–°çš„ `config.json.bak` æµè§ˆæ–°é…ç½®é¡¹

**é…ç½®é¡¹è§£è¯»**

| é…ç½®é¡¹    | è¯´æ˜                                                         | å¯é€‰å€¼                                                       |
| --------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| send_type | æ¶ˆæ¯æ¨é€ç±»å‹ **ä¸å¡«å†™åˆ™ä¸æ¨é€**                              | [server_chan](./doc/send_help/server_chan.md) [bark(Beta)](./doc/send_help/bark.md) [push_plus](./doc/send_help/push_plus.md) |
| send_key  | æ¶ˆæ¯æ¨é€æœåŠ¡çš„å¯†é’¥                                           | åœ¨æ¨é€æœåŠ¡çš„å®˜ç½‘æ³¨å†Œè·å¾—                                     |
| send_mode | æ¨é€æ¨¡å¼ æ‰“å¡å¤±è´¥æ—¶æ¨é€(fail) æ‰“å¡æˆåŠŸæ—¶æ¨é€(success) æ— è®ºæˆåŠŸä¸å¦éƒ½æ¨é€(both) **é»˜è®¤å¤±è´¥æ—¶æ¨é€** | fail success both                                            |

## å¤šäººæ‰“å¡

> ä»…æ”¯æŒ `1.2.3` ä»¥ä¸Šç‰ˆæœ¬

é…ç½®å¤šä¸ªè´¦å·ä¸€èµ·æ‰“å¡

1. åœ¨ `Github Action` ä¸Šé…ç½®

    æ·»åŠ æ–°secrets `EXT_USERS`, æŒ‰ä»¥ä¸‹æ ¼å¼å¡«å†™è´¦å·ï¼š
    
    ```text
   æ‰‹æœºå·1 å¯†ç 1
   æ‰‹æœºå·2 å¯†ç 2
   ```
   
   åŸå…ˆé…ç½®çš„secretsä¸éœ€è¦æ”¹åŠ¨ï¼Œå»ºè®®è‡ªå·±ä¿å­˜å¥½å¤šäººçš„è´¦å·å¯†ç ï¼Œä»¥ä¾¿ä»¥åå¢åŠ æˆ–åˆ é™¤è´¦å·

2. åœ¨æœ¬åœ° `config.json` ä¸Šé…ç½®

   å‚è€ƒ [config.json.bak](./config.json.bak) çš„å†…å®¹æ·»åŠ æ–°çš„é…ç½®ï¼ŒåŸé…ç½®ä¸éœ€è¦æ”¹åŠ¨

## Stargazers over time

[![Stargazers over time](https://starchart.cc/838239178/tk-auto-study.svg)](https://starchart.cc/838239178/tk-auto-study)

## é¸£è°¢

> [Pycharm](https://zh.wikipedia.org/wiki/PyCharm) æ˜¯ä¸€ä¸ªåœ¨å„ä¸ªæ–¹é¢éƒ½æœ€å¤§ç¨‹åº¦åœ°æé«˜å¼€å‘äººå‘˜çš„ç”Ÿäº§åŠ›çš„ IDEï¼Œé€‚ç”¨äº Python è¯­è¨€ã€‚

ç‰¹åˆ«æ„Ÿè°¢ [JetBrains](https://www.jetbrains.com/?from=mirai) ä¸ºå¼€æºé¡¹ç›®æä¾›å…è´¹çš„ [PyCharm](https://www.jetbrains.com/pycharm/?from=mirai) ç­‰ IDE çš„æˆæƒ

[<img src="https://github.com/mamoe/mirai/raw/dev/.github/jetbrains-variant-3.png" width="200"/>](https://www.jetbrains.com/?from=mirai)


## èµæˆ‘ä¸€æ¯Coffee

![qq_pic_merged_1633171137809](https://cdn.jsdelivr.net/gh/838239178/PicgoBed/img/qq_pic_merged_1633171137809.jpg)

